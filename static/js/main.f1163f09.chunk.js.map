{"version":3,"sources":["panels/Transport.js","panels/Map.js","panels/Settings.js","App.js","index.js"],"names":["Transport","props","id","activePanel","noShadow","size","level","onClick","go","data-to","Map","Settings","platform","App","onStoryChange","e","setState","activeStory","currentTarget","dataset","story","activeView","to","onRemove","index","fetch","state","urlObj","schedule","slice","join","method","then","res","json","data","console","log","getUrlVars","popout","snackbar","urlVars","objToQueryString","user","translations","map","need_accept_notifications","accept_notifications","dict","arrayVar","window","location","search","substr","split","i","length","valueAndKey","obj","keyValuePairs","Object","keys","push","encodeURIComponent","values","this","connect","subscribe","event","detail","type","schemeAttribute","document","createAttribute","value","scheme","body","attributes","setNamedItem","send","app_id","scope","group_id","key","tabbar","selected","data-story","text","React","Component","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.f1163f09.chunk.js","sourcesContent":["import React from 'react';\nimport { View, Panel, PanelHeader, Button } from '@vkontakte/vkui';\n\nimport '../App.css';\n\nconst Transport = props => (\n\t<View id={ props.id } activePanel='default'>\n\t\t<Panel id='default'>\n\t\t\t<PanelHeader noShadow={ true }>\n\t\t\t\tМаршруты\n\t\t\t</PanelHeader>\n\t\t\t<Button\n\t\t\t\tsize='xl'\n\t\t\t\tlevel='secondary'\n\t\t\t\tonClick={ props.go }\n\t\t\t\tdata-to='eyes'\n\t\t\t>\n\t\t\t\t60 секунд спокойствия\n\t\t\t</Button>\n\t\t</Panel>\n\t</View>\n);\n\nexport default Transport;\n","import React from 'react';\nimport { View, Panel, PanelHeader, Button } from '@vkontakte/vkui';\n\nimport '../App.css';\n\nconst Map = props => (\n\t<View id={ props.id } activePanel='default'>\n\t\t<Panel id='default'>\n\t\t\t<PanelHeader noShadow={ true }>\n\t\t\t\tКарта\n\t\t\t</PanelHeader>\n\t\t\t<Button\n\t\t\t\tsize='xl'\n\t\t\t\tlevel='secondary'\n\t\t\t\tonClick={ props.go }\n\t\t\t\tdata-to='eyes'\n\t\t\t>\n\t\t\t\t60 секунд спокойствия\n\t\t\t</Button>\n\t\t</Panel>\n\t</View>\n);\n\nexport default Map;\n\n","import React from 'react';\nimport {platform, IOS, View} from '@vkontakte/vkui';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport HeaderButton from '@vkontakte/vkui/dist/components/HeaderButton/HeaderButton';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\n\nimport '../App.css';\n\nconst osName = platform();\n\nconst Settings = props => (\n    <View id={ props.id } activePanel='default'>\n        <Panel id='default'>\n            <PanelHeader >\n                Настройки\n            </PanelHeader>\n        </Panel>\n    </View>\n);\n\n\n\nexport default Settings;\n","import React, { useState, useEffect } from 'react';\nimport connect from '@vkontakte/vk-connect';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport './App.css';\n\nimport { Root, ScreenSpinner, Epic, Tabbar, TabbarItem, View, Snackbar, Avatar } from '@vkontakte/vkui';\n\nimport Icon28SettingsOutline from '@vkontakte/icons/dist/28/settings_outline';\nimport Icon28Newsfeed from '@vkontakte/icons/dist/28/newsfeed';\nimport Icon28FavoriteOutline from '@vkontakte/icons/dist/28/favorite_outline';\n\nimport Transport from './panels/Transport';\nimport Map from './panels/Map';\nimport Settings from './panels/Settings';\n\n\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconsole.log(this.getUrlVars());\n\t\tthis.state = {\n\t\t\tactiveView: 'default',\n\t\t\tactiveStory: 'transport',  //kogda sdelaesh transport - izmeni\n\t\t\tpopout: <ScreenSpinner size='large' />,\n\t\t\tsnackbar: null,\n\t\t\turlVars: this.getUrlVars(),\n\t\t\turlObj: this.objToQueryString(this.getUrlVars()),\n\t\t\tuser: null,\n\t\t\tschedule: [],\n\t\t\ttranslations: {\n\t\t\t\tmap: 'Карта',\n\t\t\t\tneed_accept_notifications: 'Надо разрешить уведомления',\n\t\t\t\taccept_notifications: 'Розрешить',\n\n\t\t\t}\n\t\t};\n\t}\n\n\tgetUrlVars() {\n\t\tlet urlVar = window.location.search;\n\t\tlet dict = {};\n\t\tlet arrayVar = (urlVar.substr(1)).split('&');\n\t\tif (arrayVar[0] === '') return false;\n\t\tfor (let i = 0; i < arrayVar.length; i++) {\n\t\t\tlet valueAndKey = arrayVar[i].split('=');\n\t\t\tdict[valueAndKey[0]] = valueAndKey[1];\n\t\t}\n\t\treturn dict;\n\t}\n\n\tobjToQueryString(obj) {\n\t\tconst keyValuePairs = [];\n\t\tfor (let i = 0; i < Object.keys(obj).length; i += 1) {\n\t\t\tkeyValuePairs.push(`${encodeURIComponent(Object.keys(obj)[i])}=${encodeURIComponent(Object.values(obj)[i])}`);\n\t\t}\n\t\treturn keyValuePairs.join('&');\n\t}\n\n\tcomponentDidMount() {\n\t\tfetch('https://demo135.bravo.vkhackathon.com/api/translations?vk_language=' + (this.state.urlVars['vk_language'] || 'ru'))\n\t\t\t.then(res => res.json())\n\t\t\t.then((data) => {\n\t\t\t\tthis.setState({ translations: data });\n\t\t\t});\n\n\t\tconsole.log(this.state.urlVars);\n\t\tconnect.subscribe((event) => {\n\t\t\tswitch (event.detail.type) {\n\t\t\t\tcase 'VKWebAppGetUserInfoResult':\n\t\t\t\t\tfetch(`https://demo135.bravo.vkhackathon.com/api/schedule?${this.state.urlObj}`)\n\t\t\t\t\t\t.then(res => res.json())\n\t\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\tschedule: data,\n\t\t\t\t\t\t\t\tuser: event.detail.data\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\tcase 'VKWebAppUpdateConfig':\n\t\t\t\t\tlet schemeAttribute = document.createAttribute('scheme');\n\t\t\t\t\tschemeAttribute.value = event.detail.data.scheme ? event.detail.data.scheme : 'client_light';\n\t\t\t\t\tdocument.body.attributes.setNamedItem(schemeAttribute);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconsole.log('new message', event.detail.type, event.detail.data);\n\n\t\t});\n\n\t\tconnect.send('VKWebAppGetAuthToken', {\n\t\t\tapp_id: 7150429,\n\t\t\tscope: 'stories'\n\t\t});\n\t\t// connect.send('VKWebAppAllowNotifications', {});\n\t\tconnect.send('VKWebAppAllowMessagesFromGroup', {\n\t\t\tgroup_id: 186987863,\n\t\t\tkey: 'jopa'\n\t\t});\n\n\t\twindow.connect = this.connect;\n\n\t\tthis.setState({ popout: null });\n\t}\n\n\tonStoryChange = (e) => {\n\t\tthis.setState({ activeStory: e.currentTarget.dataset.story });\n\t};\n\n\tgo = (e) => {\n\t\tthis.setState({ activeView: e.currentTarget.dataset.to })\n\t};\n\n\tonRemove = (index) => {\n\t\tfetch(`https://demo135.bravo.vkhackathon.com/api/schedule?${this.state.urlObj}&times=` + [...this.state.schedule.slice(0, index), ...this.state.schedule.slice(index + 1)].join(','), {method: 'POST'})\n\t\t\t.then(res => res.json())\n\t\t\t.then((data) => {\n\t\t\t\tconsole.log(data);\n\t\t\t\tthis.setState({\n\t\t\t\t\tschedule: [...this.state.schedule.slice(0, index), ...this.state.schedule.slice(index + 1)]\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Root activeView={this.state.activeView}>\n\t\t\t\t<Epic\n\t\t\t\t\tid='default'\n\t\t\t\t\tactiveStory={this.state.activeStory}\n\t\t\t\t\ttabbar={\n\t\t\t\t\t\t<Tabbar>\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={ this.onStoryChange }\n\t\t\t\t\t\t\t\tselected={ this.state.activeStory === 'transport' }\n\t\t\t\t\t\t\t\tdata-story='transport'\n\t\t\t\t\t\t\t\ttext='Маршруты'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon28Newsfeed />\n\t\t\t\t\t\t\t</TabbarItem>\n\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={ this.onStoryChange }\n\t\t\t\t\t\t\t\tselected={ this.state.activeStory === 'map' }\n\t\t\t\t\t\t\t\tdata-story='map'\n\t\t\t\t\t\t\t\ttext= {this.state.translations.map}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon28FavoriteOutline />\n\t\t\t\t\t\t\t</TabbarItem>\n\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={ this.onStoryChange }\n\t\t\t\t\t\t\t\tselected={ this.state.activeStory === 'settings' }\n\t\t\t\t\t\t\t\tdata-story='settings'\n\t\t\t\t\t\t\t\ttext='Настройки'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon28SettingsOutline />\n\t\t\t\t\t\t\t</TabbarItem>\n\t\t\t\t\t\t</Tabbar>\n\t\t\t\t\t}>\n\t\t\t\t\t<Transport id='transport' go={ this.go } />\n\t\t\t\t\t<Map id='map' go={ this.go } />\n\t\t\t\t\t<Settings id='settings' user={ this.state.user } schedule={ this.state.schedule } go={ this.go } />\n\t\t\t\t</Epic>\n\n\t\t\t</Root>\n\t\t);\n\t}\n}\n\nexport default App;\n","import 'core-js/features/map';\nimport 'core-js/features/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vk-connect';\nimport App from './App';\n// import registerServiceWorker from './sw';\n\n// Init VK  Mini App\nconnect.send('VKWebAppInit');\n\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\n// расскомментируйте строку с registerServiceWorker();\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT\n// registerServiceWorker();\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}